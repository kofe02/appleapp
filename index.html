<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚Šã‚“ã”æ€§æ ¼è¨ºæ–­ - ã‚ãªãŸã¯ã©ã®ã‚Šã‚“ã”ã‚¿ã‚¤ãƒ—ï¼Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        
        h1 {
            color: #2d3436;
            font-size: 28px;
            font-weight: 700;
        }
        
        .subtitle {
            color: #636e72;
            margin-top: 10px;
            font-size: 16px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 30px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6c5ce7, #a29bfe);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .question-container {
            margin: 30px 0;
        }
        
        .question {
            font-size: 18px;
            color: #2d3436;
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #6c5ce7;
        }
        
        .question-number {
            color: #6c5ce7;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .question.disabled {
            opacity: 0.3;
            position: relative;
        }
        
        .scale-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }
        
        .scale-label {
            font-size: 14px;
            color: #636e72;
            min-width: 100px;
        }
        
        .scale-label.left {
            text-align: left;
            color: #ff6b6b;
            font-weight: 600;
        }
        
        .scale-label.right {
            text-align: right;
            color: #00b894;
            font-weight: 600;
        }
        
        .scale-options {
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
        }
        
        .scale-option {
            position: relative;
            width: 50px;
            height: 50px;
        }
        
        /* Size variations */
        .scale-option:nth-child(1),
        .scale-option:nth-child(7) {
            width: 50px;
            height: 50px;
        }
        
        .scale-option:nth-child(2),
        .scale-option:nth-child(6) {
            width: 45px;
            height: 45px;
        }
        
        .scale-option:nth-child(3),
        .scale-option:nth-child(5) {
            width: 40px;
            height: 40px;
        }
        
        .scale-option:nth-child(4) {
            width: 35px;
            height: 35px;
        }
        
        .scale-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
            z-index: 2;
        }
        
        .scale-circle {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }
        
        /* Apple shape - sizes */
        .scale-option:nth-child(1) .apple-shape,
        .scale-option:nth-child(7) .apple-shape {
            width: 40px;
            height: 40px;
        }
        
        .scale-option:nth-child(2) .apple-shape,
        .scale-option:nth-child(6) .apple-shape {
            width: 36px;
            height: 36px;
        }
        
        .scale-option:nth-child(3) .apple-shape,
        .scale-option:nth-child(5) .apple-shape {
            width: 32px;
            height: 32px;
        }
        
        .scale-option:nth-child(4) .apple-shape {
            width: 28px;
            height: 28px;
        }
        
        .apple-shape {
            position: relative;
            transform: scale(1);
            transition: transform 0.3s ease;
        }
        
        .apple-body {
            width: 100%;
            height: 100%;
            background: white;
            border: 3px solid #dfe6e9;
            border-radius: 50% 50% 60% 60% / 60% 60% 40% 40%;
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .apple-body::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 37.5%;
            height: 37.5%;
            background: white;
            border: 3px solid #dfe6e9;
            border-radius: 50%;
            border-bottom: none;
            clip-path: polygon(0 0, 100% 0, 100% 60%, 0 60%);
        }
        
        /* Color variations - gradient from strong to weak */
        .scale-option:nth-child(1) .apple-body,
        .scale-option:nth-child(1) .apple-body::before {
            border-color: #ff6b6b;
        }
        
        .scale-option:nth-child(2) .apple-body,
        .scale-option:nth-child(2) .apple-body::before {
            border-color: #ff9999;
        }
        
        .scale-option:nth-child(3) .apple-body,
        .scale-option:nth-child(3) .apple-body::before {
            border-color: #ffcccc;
        }
        
        .scale-option:nth-child(4) .apple-body,
        .scale-option:nth-child(4) .apple-body::before {
            border-color: #ffe4cc;
        }
        
        .scale-option:nth-child(5) .apple-body,
        .scale-option:nth-child(5) .apple-body::before {
            border-color: #ccf0e1;
        }
        
        .scale-option:nth-child(6) .apple-body,
        .scale-option:nth-child(6) .apple-body::before {
            border-color: #99e5c7;
        }
        
        .scale-option:nth-child(7) .apple-body,
        .scale-option:nth-child(7) .apple-body::before {
            border-color: #00b894;
        }
        
        /* Apple stem and leaf */
        .apple-stem {
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%) translateY(10px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 10;
            transform-origin: bottom center;
        }
        
        .stem {
            width: 3px;
            height: 8px;
            background: #8b4513;
            border-radius: 1px;
            position: relative;
            left: 2px;
        }
        
        .leaf {
            position: absolute;
            top: 2px;
            left: 4px;
            width: 8px;
            height: 5px;
            background: #00b894;
            border-radius: 0 100% 0 100%;
            transform: rotate(30deg);
        }
        
        /* Hover effect */
        .scale-option:hover .apple-shape {
            transform: scale(1.05);
        }
        
        /* Checked states with different colors */
        .scale-option:nth-child(1) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, #ff6b6b, #ff8787);
            border-color: #ff6b6b;
        }
        
        .scale-option:nth-child(2) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.8), rgba(255, 135, 135, 0.8));
            border-color: #ff9999;
        }
        
        .scale-option:nth-child(3) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.5), rgba(255, 135, 135, 0.5));
            border-color: #ffcccc;
        }
        
        .scale-option:nth-child(4) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, rgba(253, 203, 110, 0.5), rgba(255, 234, 167, 0.5));
            border-color: #ffe4cc;
        }
        
        .scale-option:nth-child(5) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.5), rgba(85, 239, 196, 0.5));
            border-color: #ccf0e1;
        }
        
        .scale-option:nth-child(6) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.8), rgba(85, 239, 196, 0.8));
            border-color: #99e5c7;
        }
        
        .scale-option:nth-child(7) input[type="radio"]:checked ~ .scale-circle .apple-body {
            background: linear-gradient(135deg, #00b894, #55efc4);
            border-color: #00b894;
        }
        
        .scale-option input[type="radio"]:checked ~ .scale-circle .apple-stem {
            opacity: 1;
            animation: popStem 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .scale-option input[type="radio"]:checked ~ .scale-circle .apple-shape {
            transform: scale(1.15);
            animation: bounceApple 0.5s ease;
        }
        
        @keyframes popStem {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(10px) scale(0) rotate(-180deg);
            }
            50% {
                opacity: 1;
                transform: translateX(-50%) translateY(-3px) scale(1.2) rotate(10deg);
            }
            100% {
                transform: translateX(-50%) translateY(0) scale(1) rotate(0);
            }
        }
        
        @keyframes bounceApple {
            0% { transform: scale(1); }
            30% { transform: scale(0.9); }
            60% { transform: scale(1.2); }
            100% { transform: scale(1.15); }
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            margin-top: 40px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .btn-prev {
            background: #ecf0f1;
            color: #636e72;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .result-container {
            display: none;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .result-title {
            font-size: 32px;
            color: #2d3436;
            margin: 30px 0;
            font-weight: 700;
        }
        
        .apple-type {
            font-size: 48px;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
            font-weight: 900;
        }
        
        .result-description {
            font-size: 18px;
            color: #636e72;
            line-height: 1.8;
            margin: 30px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .visualization-container {
            margin: 40px 0;
            display: flex;
            gap: 40px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .chart-container {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
        }
        
        #canvas3d {
            width: 100%;
            max-width: 400px;
            height: 400px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
        }
        
        .apple-3d-container {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
            text-align: center;
        }
        
        .apple-3d-info {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: #636e72;
        }
        
        .page-indicator {
            text-align: center;
            color: #636e72;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .social-links {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
        }
        
        .social-links a {
            display: inline-block;
            margin: 0 10px;
            padding: 10px 20px;
            background: #1da1f2;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .social-links a.instagram {
            background: linear-gradient(135deg, #833ab4, #fd1d1d, #fcb045);
        }
        
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .subtitle {
                font-size: 14px;
            }
            
            .question {
                font-size: 16px;
                padding: 15px;
            }
            
            .scale-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .scale-label {
                text-align: center !important;
                width: 100%;
            }
            
            .scale-label.mobile-top {
                order: 0;
            }
            
            .scale-label.mobile-bottom {
                order: 0;
            }
            
            .scale-options {
                order: -1;
                width: 80%;
                gap: 5px;
                padding: 10px 0;
            }
            
            /* Adjust apple sizes for mobile */
            .scale-option:nth-child(1),
            .scale-option:nth-child(7) {
                width: 40px;
                height: 40px;
            }
            
            .scale-option:nth-child(2),
            .scale-option:nth-child(6) {
                width: 38px;
                height: 38px;
            }
            
            .scale-option:nth-child(3),
            .scale-option:nth-child(5) {
                width: 36px;
                height: 36px;
            }
            
            .scale-option:nth-child(4) {
                width: 34px;
                height: 34px;
            }
            
            .scale-option:nth-child(1) .apple-shape,
            .scale-option:nth-child(7) .apple-shape {
                width: 40px;
                height: 40px;
            }
            
            .scale-option:nth-child(2) .apple-shape,
            .scale-option:nth-child(6) .apple-shape {
                width: 36px;
                height: 36px;
            }
            
            .scale-option:nth-child(3) .apple-shape,
            .scale-option:nth-child(5) .apple-shape {
                width: 34px;
                height: 34px;
            }
            
            .scale-option:nth-child(4) .apple-shape {
                width: 32px;
                height: 32px;
            }
            
            .navigation {
                gap: 10px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .result-title {
                font-size: 24px;
            }
            
            .apple-type {
                font-size: 36px;
            }
            
            .result-description {
                font-size: 16px;
                padding: 20px;
            }
            
            .visualization-container {
                flex-direction: column;
                gap: 30px;
            }
            
            #canvas3d {
                height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .scale-options {
                gap: 3px;
            }
            
            .apple-type {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">ğŸ</div>
                <h1>ã‚Šã‚“ã”æ€§æ ¼è¨ºæ–­</h1>
            </div>
            <p class="subtitle">59ã®è³ªå•ã§ã‚ãªãŸã®ã‚Šã‚“ã”ã‚¿ã‚¤ãƒ—ã‚’è¨ºæ–­ã—ã¾ã™</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <div id="questionContainer" class="question-container">
            <!-- Questions will be dynamically inserted here -->
        </div>
        
        <div class="navigation">
            <button class="btn btn-next" id="nextBtn" onclick="nextPage()">è¨ºæ–­çµæœã¸</button>
        </div>
        
        <div class="page-indicator" id="pageIndicator"></div>
        
        <div id="resultContainer" class="result-container">
            <h2 class="result-title">è¨ºæ–­çµæœ</h2>
            <div class="apple-type" id="appleType"></div>
            <div class="result-description" id="resultDescription"></div>
            <div class="visualization-container">
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
                <div class="apple-3d-container">
                    <canvas id="canvas3d"></canvas>
                    <div class="apple-3d-info">
                        ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å›è»¢ãƒ»ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ã‚ºãƒ¼ãƒ <br>
                        ã‚ãªãŸãŒé¸ã‚“ã ã‚Šã‚“ã”ã§ä½œã£ãŸã€ã‚ãªãŸã ã‘ã®ã‚Šã‚“ã”ã®æœ¨ã§ã™ğŸ
                    </div>
                </div>
            </div>
            <div class="social-links">
                <a href="https://twitter.com" target="_blank">X (Twitter)</a>
                <a href="https://instagram.com" target="_blank" class="instagram">Instagram</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        const questions = [
            // Redâ‡”Green questions (1-3)
            { text: "ã‚ãªãŸã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚«ãƒ©ãƒ¼ã¯ã©ã£ã¡ã«è¿‘ã„ï¼Ÿ", left: "èµ¤ã‚„ã‚ªãƒ¬ãƒ³ã‚¸", right: "é’ã‚„ç·‘", type: "RG" },
            { text: "è¾²æ¥­ã‚’ã™ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã£ã¡ãŒè‡ªåˆ†ã«åˆã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã‚‹ï¼Ÿ", left: "ã¿ã‚“ãªã§å”åŠ›ã™ã‚‹è¾²ä½œæ¥­", right: "1äººã§é›†ä¸­ã™ã‚‹è¾²ä½œæ¥­", type: "RG" },
            { text: "ã‚Šã‚“ã”ã‚’é£Ÿã¹ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã“ã§é£Ÿã¹ãŸã„ï¼Ÿ", left: "å¤–ã§ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯æ°—åˆ†ã§", right: "å®¶ã®ä¸­ã§ã‚†ã£ãã‚Š", type: "RG" },
            
            // Sweetâ‡”Tart questions (4-6)
            { text: "ã‚Šã‚“ã”ã‚’é£Ÿã¹ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã£ã¡ãŒå¥½ã¿ï¼Ÿ", left: "ç„¼ããƒªãƒ³ã‚´", right: "ç”Ÿã®ã‚Šã‚“ã”", type: "ST" },
            { text: "ã‚Šã‚“ã”ã®ã‚¹ã‚¤ãƒ¼ãƒ„ã‚’é£Ÿã¹ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã£ã¡ã®æ–¹ãŒå¥½ãï¼Ÿ", left: "ã‚Šã‚“ã”ã®ã‚³ãƒ³ãƒãƒ¼ãƒˆ", right: "ã‚Šã‚“ã”ã®ã‚·ãƒ£ãƒ¼ãƒ™ãƒƒãƒˆ", type: "ST" },
            { text: "ãŠè…¹ãŒãƒšã‚³ãºã‚³ã â€¦ç›®ã®å‰ã«ã€Œé£Ÿã¹ã¦ã¯ã„ã‘ãªã„ã€ã¨æ›¸ã‹ã‚ŒãŸã‚Šã‚“ã”ãŒï¼ã‚ãªãŸãªã‚‰ã©ã†ã™ã‚‹ï¼Ÿ", left: "å°‘ã—ãªã‚‰é£Ÿã¹ã¦ã‚‚å¤§ä¸ˆå¤«", right: "ãªã‚‹ã¹ãé£Ÿã¹ãªã„ã‚ˆã†ã«ã™ã‚‹", type: "ST" },
            
            // Earlyâ‡”Late questions (7-9)
            { text: "ã‚Šã‚“ã”ã®è¦‹ãŸç›®ãªã‚‰ã€ã©ã£ã¡ãŒå¥½ã¿ï¼Ÿ", left: "å°ã•ãã¦å½¢ã®ãã‚Œã„ãªã‚Šã‚“ã”", right: "ã²ã¨ãã‚å¤§ããã¦ç›®ç«‹ã¤ã‚Šã‚“ã”", type: "EL" },
            { text: "ã‚ã‚“ã©ãã•ãã¦å¤§å¤‰ãªä½œæ¥­ãŒã‚ã£ãŸã¨ã—ãŸã‚‰ã€ã‚ãªãŸã¯ã©ã†ã™ã‚‹ï¼Ÿ", left: "å…ˆã«ã‚„ã‚‹ã‚¿ã‚¤ãƒ—", right: "ã‚ã¨å›ã—ã«ã™ã‚‹ã‚¿ã‚¤ãƒ—", type: "EL" },
            { text: "ã‚Šã‚“ã”ã®çš®ã‚€ãã‚’é ¼ã¾ã‚Œã¡ã‚ƒã£ãŸï¼ãã‚“ãªæ™‚ã€ã‚ãªãŸãªã‚‰ã©ã†ã™ã‚‹ï¼Ÿ", left: "ã¨ã«ã‹ãã‚¹ãƒ”ãƒ¼ãƒ‡ã‚£ãƒ¼ã«ã‚„ã‚‹", right: "æ…é‡ã‹ã¤ä¸å¯§ã«ã‚„ã‚‹", type: "EL" },
            
            // Famousâ‡”Unique questions (10-12)
            { text: "ã‚ãªãŸã®æ´‹æœã‚„ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã¯ã©ã£ã¡ã«è¿‘ã„ï¼Ÿ", left: "ã¨ã«ã‹ãæµè¡Œã«ã‚ã‚ã›ã¦ãŠã“ã†â€¦æ´¾", right: "ã“ã ã‚ã‚Šã‚’ã‚‚ã£ã¦é¸ã³ãŸã„â€¦æ´¾", type: "FU" },
            { text: "æ—…è¡Œã«è¡Œãã“ã¨ã«ãªã£ãŸï¼ãã‚“ãªæ™‚ã€ã‚ãªãŸã¯ã©ã£ã¡ã«è¡ŒããŸã„ï¼Ÿ", left: "æœ‰åãªè¦³å…‰ã‚¹ãƒãƒƒãƒˆã‚’æ¥½ã—ã‚€", right: "å±±å¥¥ã®çã—ã„æ¸©æ³‰è¡—ã§ã‚†ã£ãã‚Š", type: "FU" },
            { text: "ã‚‚ã—ã‚Šã‚“ã”ã‚’è‚²ã¦ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã£ã¡ã®å¸«åŒ ã«å¼Ÿå­å…¥ã‚Šã™ã‚‹ï¼Ÿ", left: "ã¨ã«ã‹ãæ²¢å±±è‚²ã¦ã¦å£²ã‚‹ãœï¼ã‚¬ãƒƒãƒ„ç³»", right: "è‡ªåˆ†ã®å¥½ããªå“ç¨®ã—ã‹è‚²ã¦ãªã„ï¼è·äººç³»", type: "FU" }
        ];
        
        const appleTypes = {
            "RFSE": { name: "ã¤ãŒã‚‹", description: "è±Šã‹ãªç”˜ã¿ã¨ãƒ‘ãƒªãƒƒã¨ã—ãŸé£Ÿæ„ŸãŒç‰¹å¾´ã®ã€èª°ã‹ã‚‰ã‚‚æ„›ã•ã‚Œã‚‹æ—©ç”Ÿï¼ˆã‚ã›ï¼‰ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RFSL": { name: "ãµã˜", description: "èœœãŒå…¥ã‚Šã‚„ã™ãã€ç”˜ã•ã¨ã‚·ãƒ£ã‚­ã‚·ãƒ£ã‚­æ„Ÿã®ãƒãƒ©ãƒ³ã‚¹ãŒã¨ã‚ŒãŸç‹é“ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RFTE": { name: "ã‚¸ãƒ§ãƒŠã‚´ãƒ¼ãƒ«ãƒ‰", description: "å¼·ã„é…¸å‘³ã¨ç”˜ã¿ã®ãƒ¡ãƒªãƒãƒªãŒã‚ã‚Šã€æ–™ç†ã‚„ãŠè“å­ä½œã‚Šã«ã‚‚äººæ°—ã®ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RFTL": { name: "ç´…ç‰", description: "ã‚¬ãƒ„ãƒ³ã¨ãã‚‹åŠ›å¼·ã„é…¸å‘³ãŒç‰¹å¾´ã§ã€å¤ãã‹ã‚‰æ„›ã•ã‚Œã‚‹å®šç•ªå“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RUSE": { name: "æœªå¸Œã‚‰ã„ãµ", description: "ã•ã£ã±ã‚Šã¨ã—ãŸç”˜ã¿ã¨ã‚¸ãƒ¥ãƒ¼ã‚·ãƒ¼ãªæœæ±ãŒç‰¹å¾´ã®ã€å¸‚å ´ã§ã¯çã—ã„æ—©ç”Ÿï¼ˆã‚ã›ï¼‰å“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RUSL": { name: "ä¸–ç•Œä¸€", description: "è¦æ ¼å¤–ã®å¤§ãã•ã¨å„ªã—ã„ç”˜ã•ãŒç‰¹å¾´ã®ã€è´ˆç­”å“ã¨ã—ã¦ã‚‚äººæ°—ã®çã—ã„å“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RUTE": { name: "å¾¡æ‰€å·åŸ", description: "ã—ã£ã‹ã‚Šã¨ã—ãŸé…¸å‘³ãŒã‚ã‚Šã€æµé€šé‡ãŒå°‘ãªãçŸ¥ã‚‹äººãçŸ¥ã‚‹ãƒ‹ãƒƒãƒãªå“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "RUTL": { name: "ã‚€ã¤", description: "å¤§å‹ã§é£Ÿã¹å¿œãˆã®ã‚ã‚‹æœè‚‰ã¨ç¨‹ã‚ˆã„é…¸å‘³ãŒç‰¹å¾´ã®ã€ã˜ã£ãã‚Šå‘³ã‚ã„ãŸã„çã—ã„æ™©ç”Ÿï¼ˆãŠãã¦ï¼‰å“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GFSE": { name: "ãƒˆã‚­", description: "ç”˜ã¿ãŒå¼·ãé…¸å‘³ãŒå°‘ãªã„ã€çˆ½ã‚„ã‹ãªå‘³ã‚ã„ãŒç‰¹å¾´ã®ã€è¿‘å¹´äººæ°—ã®é«˜ã„é»„è‰²ã„ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GFSL": { name: "ç‹æ—", description: "å¼·ã„ç”˜ã•ã¨ç‹¬ç‰¹ãªé¦™ã‚ŠãŒç‰¹å¾´ã®ã€èª°ã‚‚ãŒçŸ¥ã‚‹ç·‘é»„è‰²ã®å®šç•ªå“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GFTE": { name: "ããŠã†", description: "ã•ã£ã±ã‚Šã¨ã—ãŸé…¸å‘³ã¨ã‚·ãƒ£ã‚­ã‚·ãƒ£ã‚­æ„ŸãŒç‰¹å¾´ã®ã€åˆç§‹ã«å‡ºå›ã‚‹çˆ½ã‚„ã‹ãªé»„è‰²ã„ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GFTL": { name: "ã‚·ãƒŠãƒã‚´ãƒ¼ãƒ«ãƒ‰", description: "å¿ƒåœ°ã‚ˆã„é…¸å‘³ã¨ãƒ‘ãƒªãƒƒã¨ã—ãŸé£Ÿæ„ŸãŒç‰¹å¾´ã®ã€è²¯è”µæ€§ã®é«˜ã„é»„è‰²ã„ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GUSE": { name: "ãã‚“ã¾åæœˆ", description: "æ¿ƒåšãªç”˜ã¿ã¨ã»ã®ã‹ãªé¦™ã‚ŠãŒç‰¹å¾´ã®ã€å¸Œå°‘ãªé»„è‰²ã„é«˜ç´šå“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GUSL": { name: "é‡‘æ˜Ÿ", description: "ä¸Šå“ã§ã¾ã‚ã‚„ã‹ãªç”˜ã•ãŒç‰¹å¾´ã®ã€è¡¨é¢ã®ã‚µãƒ“ãŒç‰¹å¾´çš„ãªçã—ã„é»„è‰²ã„ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GUTE": { name: "ç¥", description: "æ˜”ãªãŒã‚‰ã®çˆ½ã‚„ã‹ãªé…¸å‘³ãŒç‰¹å¾´ã®ã€ä¸€éƒ¨ã®åœ°åŸŸã§ã—ã‹æµé€šã—ãªã„éå¸¸ã«çã—ã„å“ç¨®ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" },
            "GUTL": { name: "ã¯ã¤æ‹ãã‚Šã‚“", description: "é®®çƒˆãªé…¸å‘³ã¨ã‚·ãƒ£ãƒ¼ãƒ—ãªé¦™ã‚ŠãŒç‰¹å¾´ã®ã€æ–°ã—ã„å“ç¨®ã§ãƒ‹ãƒƒãƒãªãƒ•ã‚¡ãƒ³ãŒå¤šã„ã‚Šã‚“ã”ã¯ã€ãã£ã¨ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã¯ãšï¼" }
        };
        
        // Define apple colors for each position
        const appleColors = [
            '#ff6b6b', // Position 1 - Strong red
            '#ff9999', // Position 2 - Medium red
            '#ffcccc', // Position 3 - Light red
            '#ffe4cc', // Position 4 - Yellow
            '#ccf0e1', // Position 5 - Light green
            '#99e5c7', // Position 6 - Medium green
            '#00b894'  // Position 7 - Strong green
        ];
        
        const appleSizes = [1.0, 0.9, 0.8, 0.7, 0.8, 0.9, 1.0]; // Size multipliers for each position
        
        let currentPage = 0;
        const questionsPerPage = 12;
        const totalPages = Math.ceil(questions.length / questionsPerPage);
        let answers = new Array(questions.length).fill(null);
        
        function renderQuestions() {
            const start = currentPage * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const container = document.getElementById('questionContainer');
            const isMobile = window.innerWidth <= 768;
            container.innerHTML = '';
            
            for (let i = start; i < end; i++) {
                const q = questions[i];
                const questionDiv = document.createElement('div');
                
                let isDisabled = false;
                for (let j = 0; j < i; j++) {
                    if (answers[j] === null) {
                        isDisabled = true;
                        break;
                    }
                }
                
                questionDiv.className = isDisabled ? 'question disabled' : 'question';
                
                if (isMobile) {
                    questionDiv.innerHTML = `
                        <span class="question-number">Q${i + 1}.</span> ${q.text}
                        <div class="scale-container">
                            <div class="scale-label left mobile-top">${q.left}</div>
                            <div class="scale-options">
                                ${[1, 2, 3, 4, 5, 6, 7].map(value => `
                                    <div class="scale-option">
                                        <input type="radio" id="q${i}_${value}" name="q${i}" value="${value}" 
                                               ${answers[i] === value ? 'checked' : ''}
                                               onchange="saveAnswer(${i}, ${value})">
                                        <label for="q${i}_${value}" class="scale-circle">
                                            <div class="apple-shape">
                                                <div class="apple-body"></div>
                                                <div class="apple-stem">
                                                    <div class="stem"></div>
                                                    <div class="leaf"></div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="scale-label right mobile-bottom">${q.right}</div>
                        </div>
                    `;
                } else {
                    questionDiv.innerHTML = `
                        <span class="question-number">Q${i + 1}.</span> ${q.text}
                        <div class="scale-container">
                            <div class="scale-label left">${q.left}</div>
                            <div class="scale-options">
                                ${[1, 2, 3, 4, 5, 6, 7].map(value => `
                                    <div class="scale-option">
                                        <input type="radio" id="q${i}_${value}" name="q${i}" value="${value}" 
                                               ${answers[i] === value ? 'checked' : ''}
                                               onchange="saveAnswer(${i}, ${value})">
                                        <label for="q${i}_${value}" class="scale-circle">
                                            <div class="apple-shape">
                                                <div class="apple-body"></div>
                                                <div class="apple-stem">
                                                    <div class="stem"></div>
                                                    <div class="leaf"></div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="scale-label right">${q.right}</div>
                        </div>
                    `;
                }
                container.appendChild(questionDiv);
            }
            
            updateNavigation();
            updateProgress();
        }
        
        function saveAnswer(questionIndex, value) {
            answers[questionIndex] = value;
            renderQuestions();
        }
        
        function updateNavigation() {
            const nextBtn = document.getElementById('nextBtn');
            const pageIndicator = document.getElementById('pageIndicator');
            
            prevBtn.disabled = currentPage === 0;
            
            if (currentPage === totalPages - 1) {
                nextBtn.textContent = 'è¨ºæ–­çµæœã‚’è¦‹ã‚‹';
                nextBtn.onclick = showResults;
            } else {
                nextBtn.textContent = 'æ¬¡ã¸';
                nextBtn.onclick = nextPage;
            }
            
            pageIndicator.textContent = `${currentPage + 1} / ${totalPages} ãƒšãƒ¼ã‚¸`;
        }
        
        function updateProgress() {
            const progress = ((currentPage + 1) / totalPages) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }
        
        function nextPage() {
            const start = currentPage * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            let allAnswered = true;
            
            for (let i = start; i < end; i++) {
                if (answers[i] === null) {
                    allAnswered = false;
                    break;
                }
            }
            
            if (!allAnswered) {
                alert('ã“ã®ãƒšãƒ¼ã‚¸ã®ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ã‹ã‚‰æ¬¡ã¸é€²ã‚“ã§ãã ã•ã„ã€‚');
                return;
            }
            
            if (currentPage < totalPages - 1) {
                currentPage++;
                renderQuestions();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
        
        function previousPage() {
            if (currentPage > 0) {
                currentPage--;
                renderQuestions();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
        
        function calculateResult() {
            const unanswered = answers.filter(a => a === null).length;
            if (unanswered > 0) {
                alert(`ã¾ã  ${unanswered} å€‹ã®è³ªå•ã«å›ç­”ã—ã¦ã„ã¾ã›ã‚“ã€‚ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚`);
                return null;
            }
            
            let scores = {
                R: 0, G: 0,
                S: 0, T: 0,
                E: 0, L: 0,
                F: 0, U: 0
            };
            
            questions.forEach((q, i) => {
                const value = answers[i];
                const normalizedValue = (value - 4) / 3;
                
                switch(q.type) {
                    case 'RG':
                        if (normalizedValue < 0) scores.R += Math.abs(normalizedValue);
                        else scores.G += normalizedValue;
                        break;
                    case 'ST':
                        if (normalizedValue < 0) scores.S += Math.abs(normalizedValue);
                        else scores.T += normalizedValue;
                        break;
                    case 'EL':
                        if (normalizedValue < 0) scores.E += Math.abs(normalizedValue);
                        else scores.L += normalizedValue;
                        break;
                    case 'FU':
                        if (normalizedValue < 0) scores.F += Math.abs(normalizedValue);
                        else scores.U += normalizedValue;
                        break;
                }
            });
            
            const color = scores.R > scores.G ? 'R' : 'G';
            const popularity = scores.F > scores.U ? 'F' : 'U';
            const taste = scores.S > scores.T ? 'S' : 'T';
            const season = scores.E > scores.L ? 'E' : 'L';
            
            return {
                type: color + popularity + taste + season,
                scores: scores
            };
        }
        
        function create3DAppleTree() {
            const canvas = document.getElementById('canvas3d');
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            
            const camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 1000);
            camera.position.set(0, 5, 15);
            
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.shadowMap.enabled = true;
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 10);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // Ground
            const groundGeometry = new THREE.CircleGeometry(10, 32);
            const groundMaterial = new THREE.MeshLambertMaterial({ color: 0x98FB98 });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.position.y = -2;
            ground.receiveShadow = true;
            scene.add(ground);
            
            // Tree trunk
            const trunkGeometry = new THREE.CylinderGeometry(0.5, 0.8, 4, 8);
            const trunkMaterial = new THREE.MeshLambertMaterial({ color: 0x8B4513 });
            const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
            trunk.position.y = 0;
            trunk.castShadow = true;
            scene.add(trunk);
            
            // Tree crown (leaves)
            const crownGeometry = new THREE.SphereGeometry(3.5, 16, 16);
            const crownMaterial = new THREE.MeshLambertMaterial({ color: 0x228B22 });
            const crown = new THREE.Mesh(crownGeometry, crownMaterial);
            crown.position.y = 3.5;
            crown.scale.y = 0.8;
            crown.castShadow = true;
            scene.add(crown);
            
            // Add apples based on user answers
            const appleGroup = new THREE.Group();
            let appleCount = 0;
            
            answers.forEach((answer, index) => {
                if (answer !== null) {
                    const position = answer - 1; // Convert 1-7 to 0-6
                    const color = appleColors[position];
                    const size = appleSizes[position] * 0.3;
                    
                    // Random position on tree
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.random() * Math.PI * 0.5 + Math.PI * 0.25;
                    const radius = 2.5 + Math.random() * 1.5;
                    
                    const x = radius * Math.sin(phi) * Math.cos(theta);
                    const y = radius * Math.cos(phi) + 3;
                    const z = radius * Math.sin(phi) * Math.sin(theta);
                    
                    // Apple
                    const appleGeometry = new THREE.SphereGeometry(size, 16, 16);
                    const appleMaterial = new THREE.MeshPhongMaterial({ 
                        color: color,
                        shininess: 100,
                        specular: 0x222222
                    });
                    const apple = new THREE.Mesh(appleGeometry, appleMaterial);
                    apple.position.set(x, y, z);
                    apple.scale.y = 1.1;
                    apple.castShadow = true;
                    
                    // Add stem
                    const stemGeometry = new THREE.CylinderGeometry(0.02, 0.02, 0.1, 4);
                    const stemMaterial = new THREE.MeshLambertMaterial({ color: 0x654321 });
                    const stem = new THREE.Mesh(stemGeometry, stemMaterial);
                    stem.position.set(x, y + size + 0.05, z);
                    
                    appleGroup.add(apple);
                    appleGroup.add(stem);
                    appleCount++;
                }
            });
            
            scene.add(appleGroup);
            
            // Mouse controls
            let mouseX = 0;
            let mouseY = 0;
            let targetRotationX = 0;
            let targetRotationY = 0;
            
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                mouseX = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                mouseY = -((e.clientY - rect.top) / rect.height) * 2 + 1;
            });
            
            // Touch controls for mobile
            canvas.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1) {
                    const rect = canvas.getBoundingClientRect();
                    const touch = e.touches[0];
                    mouseX = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
                    mouseY = -((touch.clientY - rect.top) / rect.height) * 2 + 1;
                }
            });
            
            // Animation
            function animate() {
                requestAnimationFrame(animate);
                
                targetRotationY = mouseX * Math.PI * 0.5;
                targetRotationX = mouseY * Math.PI * 0.2;
                
                appleGroup.rotation.y += (targetRotationY - appleGroup.rotation.y) * 0.05;
                crown.rotation.y = appleGroup.rotation.y * 0.3;
                
                // Gentle floating animation for apples
                appleGroup.children.forEach((child, i) => {
                    if (child.geometry instanceof THREE.SphereGeometry) {
                        child.position.y += Math.sin(Date.now() * 0.001 + i) * 0.002;
                    }
                });
                
                renderer.render(scene, camera);
            }
            
            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            });
            
            animate();
        }
        
        function showResults() {
            const result = calculateResult();
            if (!result) return;
            
            const appleType = appleTypes[result.type];
            
            document.getElementById('questionContainer').style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            document.querySelector('.page-indicator').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            
            document.getElementById('appleType').textContent = appleType.name;
            document.getElementById('resultDescription').textContent = appleType.description;
            
            // Calculate percentages for radar chart
            const totalRG = result.scores.R + result.scores.G;
            const totalST = result.scores.S + result.scores.T;
            const totalEL = result.scores.E + result.scores.L;
            const totalFU = result.scores.F + result.scores.U;
            
            const redPercent = totalRG > 0 ? (result.scores.R / totalRG) * 100 : 50;
            const sweetPercent = totalST > 0 ? (result.scores.S / totalST) * 100 : 50;
            const earlyPercent = totalEL > 0 ? (result.scores.E / totalEL) * 100 : 50;
            const famousPercent = totalFU > 0 ? (result.scores.F / totalFU) * 100 : 50;
            
            // Create radar chart
            const ctx = document.getElementById('radarChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: [
                        `èµ¤ã„ (${redPercent.toFixed(0)}%)`,
                        `ç”˜ã„ (${sweetPercent.toFixed(0)}%)`,
                        `æ—©ã„ (${earlyPercent.toFixed(0)}%)`,
                        `æœ‰å (${famousPercent.toFixed(0)}%)`
                    ],
                    datasets: [{
                        label: 'ã‚ãªãŸã®ãƒãƒ©ãƒ³ã‚¹',
                        data: [redPercent, sweetPercent, earlyPercent, famousPercent],
                        backgroundColor: 'rgba(108, 92, 231, 0.2)',
                        borderColor: 'rgba(108, 92, 231, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(108, 92, 231, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(108, 92, 231, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Create 3D apple tree
            create3DAppleTree();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Initialize
        window.addEventListener('resize', renderQuestions);
        renderQuestions();
    </script>
</body>
</html>